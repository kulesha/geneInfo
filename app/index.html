<!doctype html>
<html>
<head>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/geneInfo.css">

</head>
<body ng-app="geneInfoApp">
    <h1>geneInfo</h1>
    <div ng-controller="geneInfoCtrl as gi">
        <form>
            <div class="row">
                <div class="col-xs-2">
                    <div class="input-group">
                        <input type="text" name="geneName" class="form-control" placeholder="Enter gene name" ng-model="formInfo.gene"/>    
                        <span class="input-group-btn">
                            <button type="submit" class="btn btn-success" ng-click="gi.findGene()">Find</button>
                        </span>
                    </div>
                </div>
            </div>                    
        </form>
        <br/>
        <div ng-show="geneInfo.id" ng-controller="TabController as tab">            
            <table class="table">
                <tr>
                    <th>Gene name</th><td><b>{{geneInfo.display_name}}</b> <em>(Ensembl ID: {{geneInfo.id}} ) </em></td>
                </tr>
                <tr>
                    <th>Description</th><td>{{geneInfo.description}}</td>
                </tr>
                <tr>
                    <th>Location</th><td>{{geneInfo.seq_region_name}} : {{geneInfo.start | number}} - {{geneInfo.end | number}}</td>
                </tr>
                <tr>               
                    <th>Length</th><td> {{geneInfo.end - geneInfo.start | number}}bp</td>
                </tr>
            </table>
            
            <table class="table table-strip"  >
                <tr><th colspan="10">{{geneInfo.display_name}} transcripts</th></tr>
                <tr>
                    <td  style="vertical-align:text-top; width:100px">
                        <ul class="nav nav-pills nav-stacked">
                            <li ng-repeat="transcript in geneInfo.Transcript" ng-class="{active:tab.isSet(transcript.id)}"
                                ng-click="tab.setTab(transcript.id)"><a href="#">{{transcript.id}}</a></li>
                        </ul>
                    </td>
                    <td>
                        <div ng-repeat="transcript in geneInfo.Transcript" ng-show="tab.isSet(transcript.id)">
                            <table class="table table-condensed table-strip">
                                <tr ng-show="transcript.protein">
                                    <th>Translation</th><td>{{transcript.Translation.id}}</td>
                                </tr>
                                <tr ng-show="transcript.protein">
                                    <th>Length</th><td>{{transcript.protein.length}} aa</td>
                                </tr>
                                <tr><th colspan="2">{{transcript.Exon.length}} exons</th></tr>
                                <tr ng-repeat="exon in transcript.Exon">
                                    <td>{{exon.id}}</td>
                                    <td>{{exon.start - geneInfo.start}} .. {{exon.end - geneInfo.start}}</td>
                                </tr>
                            </table>
                        </div>                
                    </td>
                    <td >
                        <table>
                            <tr ng-repeat="segment in geneInfo.segments">
                                <td>
                                    <table style="line-height:10px">
                                        <tr>
                                            <td style="width:50px;text-align:right;">{{ ($index*120) + 1 | number }}:</td>
                                            <td><pre><span ng-bind-html="geneInfo.segments[$index]"></span></pre></td>
                                        </tr>
                                        <tr ng-show="geneInfo.psegments[$index].indexOf('-') > -1">
                                            <td>&nbsp;</td>
                                            <td><pre>{{geneInfo.psegments[$index]}}</pre></td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.3/angular.min.js"></script>
    <script src="//code.angularjs.org/1.2.20/angular-sanitize.min.js"></script>
    <script type="text/javascript" src="/js/geneInfo.js"></script>
</body>
</html>
